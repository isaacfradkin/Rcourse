---
title: "Lesson 10: Simulations" 
author: "Copyright 2024 Psychology Department. Hebrew University of Jerusalem. All rights reserved"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: false


description: >
 <div style='direction: rtl;'>
 
 </div>
       
runtime: shiny_prerendered  
editor_options: 
  markdown: 
    wrap: 72
---


```{=html}
<style>
h1, h2, h3, h4, h5, h6 {
  direction: rtl;
}
p {
  direction: rtl;
}
.text-block1 {
  direction: rtl;       /* Set text direction to right-to-left */
  text-align: right;
  background-color: #e7f3fe; /* Light grey background */
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #ddd; /* Light border */
  margin: 10px 0; /* Space around the block */
}
</style>

```

```{r setup, include=FALSE}
library(learnr)
library(gradethis)
library(Rcourse)
library(ggplot2)
library(tidyverse)

knitr::opts_chunk$set(error = TRUE)
gradethis::gradethis_setup()
```

```{r prepare-df1}

```

## מבוא

במהלך הקורס עד כה התעסקנו רק בניתוח של נתונים אמיתיים. ביחידה זו נלמד כישור חדש - איך ליצור נתונים על סמך הדמיה כדי לבדוק רעיונות תיאורטיים. נלמד כיצד ליצור נתונים מתוך סימולציות ולנתח אותם.

הרעיון יהיה זהה בכל אחת מהדוגמאות שנפגוש ביחידה זו: אנחנו נניח הנחות מסוימות על המציאות ואז נבדוק את התוצאות שהיינו מצפים לקבל בהינתן הנחות אלו. תהליך זה יאפשר לנו לערוך סימולציות של התפלגויות דגימה, במטרה להבין את מידת הרעש הצפויה לנו בנתונים המתבססים על דגימה אקראית ולערוך מבחן עוצמה למבחנים סטטיסטיים פשוטים.

במהלך היחידה נכיר את השימוש בפונקציות הבאות:

**


## התפלגות דגימה

### דגימה מתוך התפלגות בינומית

הסימולציה הפשוטה ביותר שנוכל לבצע כוללת הדמיה של הטלת מטבע. כיוון שלפעולה זו יש רק 2 תוצאות אפשריות היא מקבילה לדימה מהתפלגות בינומית - המתארת דגימה של 0 או 1 עם הסתברות p ו 1-p.

בR אפשר לבצע דגימה כזו באמצעות הפונקציה `rbinom`.

להלן דוגמה:

```{r}
coin_flip = rbinom(n = 1, size = 1, prob = 0.5)

print(coin_flip)
```

תריצו את הקוד כמה פעמים ותראו שהתוצאה תשתנה בכל פעם. כשקיבלנו 1 המטבע נפל על "עץ" וכשקיבנו 0 המטבע נפל על "פלי".

במידה ונרצה לבצע הטלה של יותר ממטבע אחד נוכל לשנות את הערך של `size` בפונקציה `rbinom`. כעת הפונקציה תחזיר לנו את מספר הפעמיים שקיבלנו "עץ" מתוך כל ההטלות שערכנו.

```{r}
num_heads = rbinom(n = 1, size = 100, prob = 0.5)

print(num_heads)
```

במקרה הנ"ל בדקנו כמה פעמים קיבלו "עץ" מתוך 100 הטלות של מטבע, אבלביצענו את הבדיקה הזו פעם אחת בלבד. כיוון שאנחנו יודעים שהתהליך המתואר הוא אקראי, נרצה לחזור עליו מספר רב של פעמים כדי לראות מה היא ההתפלגות של כלל התוצאות שאנחנו יכולים לקבל עבור 100 הטלות מטבע. התפלגות זו תתאר לנו את התפלגות הדגימה של מספר הפעמים שנקבל עץ עבור מתוך 100 הטלות.

במקרה זה, נוכל ליישם את החזרות  המרובות באמצעות שינוי של הערך של `n` בפונקציה `rbinom`. כשנזין מספר גדול מ1 במקום זה נקבל חזרה וקטור של תוצאות, כשכל ערך בוקטור מבטא חזרה נפרדת על ההטלות שביקשנו.

```{r}
num_heads = rbinom(n = 50, size = 100, prob = 0.5)

print(num_heads)
```

קיבלנו וקטור באורך 50, המכילים את התוצאות מ50 חזרות, כשבכל חזרה הטלנו 100 מטבעות.

נחזור על התהליך שוב, אבל הפעם נחזור על התהליך 1000 פעם ונציג את התוצאות בצורה גרפית.


דגימה של ניסוי אחד וחישוב סטטיסטי
חזרה דרך לולאה ובניית התפלגות דגימה

השוואה לפתרון אנליטי


### דגימה מתוך התפלגות נורמלית


### דגימה מאוכלוסייה שאינה נורמלית

משפט הגבול המרכזי
הפרה של מפשט הגבול המרכזי


### דגימה מתוך וקטור

סימולציה של תוצאות הטלת קוביות 



## מבחני עוצמה

מקרה שימוש במיוחד - בדיקת הסיכוי לקבל תוצאה מובהקת
נערוך ניסוי שלם, כולל מבחן סטטיסטי ונראה בכמה אחוזים קיבלנו תוצאה מובהקת

הנחות - ושאלה שאותה אנחנו בודקים

### מבחן Z

מהלך הניסוי:
דגימה
חישוב סטטיסטי - ציון Z
המרת ערך הZ לערך P באמצעות הפונקציה pnorm()
דחינו את השערת האפס או לא?

חזרה על התהליך בלולאה

השוואה לפתרון אנליטי
















### התפלגות דגימה

נדמיין מצב בו משתנה רמת הדיכאון באוכלוסייה מסויימת מתפלג נורמלית עם תוחלת 30 וס"ת 10 

```{r}
x = rnorm(30, 30,10)
mn = mean(x)
ggplot(data.frame(x), aes(x)) +
  geom_histogram(bins = 30, fill = "lightblue", color = "black")+
  geom_vline(xintercept = mn, color = "red", linetype = "dashed")

```

```{r}
mns = c()
for (i in 1:20000){
  x = rnorm(30, 30,10)
  mn = mean(x)
  mns = c(mns, mn)
}

ggplot(data.frame(mns), aes(mns)) +
  geom_histogram()

```


## הגשה
  עברו על הקובץ וודאו שהגשתם את כל התרגילים ועניתם על כל השאלות
  
  במידה וכל התשובות שלכם תקינות יש ללחוץ על הכפתור:  Generate, להעתיק את הטקסט שמופיע בחלון למטה ולהגישו במודל  
  בהצלחה!

```{r context="server"}
learnrhash::encoder_logic()
```

```{r encode, echo=FALSE}
learnrhash::encoder_ui()
```